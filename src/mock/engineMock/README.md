# エンジンモックのドキュメント

## 概要

通信を介さずに音声合成できるエンジンのモックです。

同じ入力には同じ出力を返し、別の入力には別の出力を返すようになっています。
また出力を見たときにUIや処理の実装の異常に気付けるように、ある程度直感に合う出力を返すよう努力されています。

例：音量を下げると音声が小さくなる、音程と周波数が一致する、など。

モックの実装は気軽に破壊的変更しても問題ありません。

## ビルド戦略

ブラウザ版でも使えるようにすべく、ソフトウェアにも組み込める形で実装されています。
ビルド時のモックエンジンの取り扱いポリシーはこんな感じです。

- 重い処理が一切実行されないようにする
  - 辞書の初期化、画像の読み込みなど
- なるべく重いファイルはビルドに含まれないようにする
  - 形態素解析の辞書ファイルやダミー画像など

## ファイル構成

- `talkModelMock.ts`
  - トーク用の音声クエリを作るまでの処理周り
- `singModelMock.ts`
  - ソング用の音声クエリを作るまでの処理周り
- `audioQueryMock.ts`
  - 音声クエリ周り
- `synthesisMock.ts`
  - 音声波形の合成周り
- `characterResourceMock.ts`
  - キャラ名や画像などのリソース周り
- `phonemeMock.ts`
  - 音素周り
- `manifestMock.ts`
  - エンジンのマニフェスト周り

## kuromoji.jsについて

本家kuromoji.jsはパス操作周りでエラーが起こるので、フォーク版を使っています。
mock用途以外にkuromoji.jsを使う予定はなく、もし動かなくなった際は依存を切ることも検討します。
